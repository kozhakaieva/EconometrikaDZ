---
title: "google"
author: "Kogakaeva Luba"
date: '6 ноября 2016 г '
output: html_document
---
 Задача 5."Что скрывает GOOGLE?"

# Пункт 1 
```{r goog}
plot(goog)
```
Есть очевидные выбросы в отношении с переменными pop(численностью населения) и hdi(индекс развития человеческого потенциала).

# Пункт 2 
```{r goog}
which.max (goog$pop)
goog_sub = subset (goog, goog$country! = "india")
plot(goog_sub)
```
Было определено,что страна с самой высокой численностью населения-это Индия.Индия-это 10 наблюдение в наборе данных.Население остальных стран не сильно отличается от общей массы,но видно,что например США-вторая по численности страна,Бразилия-третья.

# Пункт 3 
```{r}
table(goog_sub$dem)
goog_sub$dem=relevel(goog_sub$dem,ref=”hybrid”)
```
С помощью функции table была построена частотная таблица для переменной dem(уровня демократии в странах).Уровень free-является отсчётом по умолчанию.С помошью функции relevel() был изменён уровень отсчёта на hybrid.

# Пункт 4 
```{r}
fing = lm (complied~requests+pop+hdi+dem+internet+ freepress, data = goog_sub)
summary (fing)
```
В данном уравнении нет значимых переменных,так как значение всех p value больше чем 0.1 даже.Коэффициент R^2=0.4559 средний,ближе к высокому качеству модели,а значит здесь присутствует проблема мультиколлинеарности переменных.

# Пункт 5 
```{r}
predict (fin)
predict(fin,newdata=new.request,interval="prediction")
```
США-это 26 строчка этого набора данных. Предсказанная доля выполненных запросов для США на основе модели составляет 94.790796% запросов, которые выполнил Google, на основе объясняющих переменных.

# Пункт 6 
```{r}
fing$residuals
plot(fing$residuals)
```
С помощью функции residuals были получены остатки.Также была построена диаграмма рассеяния остатков.По ней можно сделать вывод,что связь между остатками преимущественно линейная и рассеяние вокруг линии является абсолютным шумом. При росте предсказанных значений вариабельность остатков остается константой. 

# Пункт 7 
```{r}
finn<-lm(complied~requests+country+internet+dem,data=goog_sub)
stepAIC(finn,direction="backward")
```
Был реализован алгоритм регрессии методом пошагового исключения переменных.В ходе алгоритма были удалены переменные с наименьшим значением AIC,а именно requests и dem.Можно сделать вывод,что переменная complied зависит от двух переменных: от country и internet.То есть доля запросов к Google, которые были удовлетворены, больше всего зависит от страны, где идут запросы и наличия интернета у людей.Ну и, в свою очередь,между этими переменными нет сильной взаимосвязи.
